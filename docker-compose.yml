version: "3"
# this file uses prebuilt image in dockerhub
services:
  jekyll:
    image: amirpourmand/al-folio
    container_name: al-folio-website
    # Ensure gems are installed at container start, then serve the site.
    # Use bundle install with retry to be resilient to transient network errors.
    command: bash -c "\
      bundle config set --local path 'vendor/bundle' && \
      bundle install --jobs=4 --retry=3 && \
      bundle exec jekyll serve --watch --port=8080 --host=0.0.0.0 --livereload --verbose --trace"
    ports:
      # Host port is configurable via the PORT environment variable (default 8080)
      - "${PORT:-8080}:8080"
    volumes:
      - .:/srv/jekyll